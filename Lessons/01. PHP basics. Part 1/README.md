## Основы PHP

### Базовый синтаксис

#### PHP теги

Любой `PHP` скрипт начинается на тег `<?php`.

В том случае, если файл содержит только `PHP`, он заканчивается новой
строкой (`LF`) [PSR-12](https://www.php-fig.org/psr/psr-12/)

```injectablephp
<?php

// ... PHP code ...

```

Если же файл содержит смесь `PHP` и `HTML`, `PHP` код обязательно должен находиться внутри тегов `<?php` и `?>` :

```
<html>
<body>
    <?php
        // ... PHP code ...
    ?>
</body>
</html>
```

### Переменные

Переменные в `PHP` начинаются со знака `$`, после которого следует имя переменной.

**Правила именования переменных:**

- имя переменной должно начинаться с буквы или символа подчеркивания;
- имя переменной может содержать буквы, цифры, символы подчеркивания;
- имя переменной чувствительно к регистру.

```injectablephp
<?php
$variable = 'Test1';
$VariablE = 'Test2';

echo $variable.$VariablE;

$5variableWithError = 'Test3';
$_5correctVariable = 'Test4';
$названиеНаРусском = 'Test5';

```

Присвоение в переменную выражения другой переменной происходит при помощи копирования выражения. Поэтому изменения одной
из переменной не меняет другую.

```injectablephp
<?php

$variable1 = 3;
$variable2 = $variable1;
$variable2 += 3;

echo $variable2;
echo $variable1;

```

Однако, изменение переменной после присвоения в другую переменную возможно по "присвоению по ссылке". Новая переменная
ссылается на оригинальную переменную.

_Присвоить по ссылке можно только именованную переменную_

```injectablephp
<?php

$variable1 = 3;
$variable2 = &$variable1;
$variable2 += 3;

echo $variable2;
echo $variable1;


$variableWithError = &25;

```

### Вывод значений переменной PHP

`echo` - языковая конструкция для вывода одного или более выражений. Ничего не возвращает.

`print` - языковая конструкция для вывода одного выражения. Возвращает всегда 1.

`var_dump` - функция, которая выводит информацию об одном или нескольких выражений, включая их тип и значение. Ничего не
возвращает

`print_r` - функция, которая выводит удобочитаемую информацию о переменной. Возвращает строку или `true`.

```injectablephp
<?php

echo 'One', 'Two', 'Three';

//Ошибка: print поддерживает только вывод одного выражения
print 'One', 'Two', 'Three';
//Корректное выражение
print 'One';

var_dump('One', 'Two', 'Three');

//Ошибка: print_r поддерживает только вывод одного выражения
print_r('One', 'Two', 'Three');
print_r('One');

```

### Константы

Константа — имя для простого неизменяемого значения. Константы чувствительны к регистру. Имена констант стоит всегда
писать в верхнем регистре.

Наименование константы аналогично наименованию переменных.

```injectablephp
<?php

//Определение константы
define('MY_CONSTANT', 8);
var_dump(MY_CONSTANT);
//Определение константы 
const MY_CONSTANT2 = 5;
var_dump(MY_CONSTANT2);
MY_CONSTANT2 = 18;

```

### Области видимости переменных

Переменная может быть использована в определенной области видимости, в зависимости от того, где переменная определена.

Например, 2_variables.php

Области видимости:

- локальные. Переменная объявлена внутри функции
- глобальные. Переменная объявлена вне функции

Пример использования переменной с ошибкой:

```injectablephp
<?php

$variable = 5;

function checkVariable()
{
    echo $variable;
}

echo $variable;

checkVariable();

```

Пример использования глобальной переменной:

```injectablephp
<?php

$variable = 5;

function checkVariable()
{
    global $variable;
    $variable += 7;
    echo $variable;
}

echo $variable;

checkVariable();

```

Разновидностью локальной переменной является **_статическая_** переменная, которая хранит значение в локальной области
вилимости.

```injectablephp
<?php

$variable = 5;

function checkVariable()
{
    static $variable = 0;
    $variable += 7;
    echo $variable;
}

var_dump($variable);

checkVariable();

var_dump($variable);

```

[*Дополнительная информация по области видимости переменных](https://www.php.net/manual/ru/language.variables.scope.php)

### Типы данных

`PHP` не требует и не поддерживает явного типа для определенной переменной, тип переменной зависит от присвоенного
значения.

Скалярные типы:

1. `bool` - логический тип (может быть `true` `false`)
2. `int` - целочисленный тип
3. `float` - число с плавающей точкой
4. `string` - строковый тип

Смешанные типы:

1. `array` - массивы
2. `object` - объекты
3. `callable` - функции обратного вызова ([callback-функции](https://www.php.net/manual/ru/language.types.callable.php))
4. `iterable` - псевдотип, реализующий интерфейс [Traversable](https://www.php.net/manual/ru/class.traversable.php),
   который итерируется с помощью `foreach`

Специальные типы:

1. `resource` - [типы ресурсов](https://www.php.net/manual/ru/resource.php)
2. `NULL`

```injectablephp
<?php

$variable = 3;
echo gettype($variable);

$variable = 'Three';
echo gettype($variable);

if (is_string($variable)) {
    echo "String: $variable";
} elseif (is_int($variable)) {
    echo "Int: $variable";
}

```

### Операторы

Операторы выполняют операции с выражениями (значениями) для вычисления нового значения.

В `PHP`существует порядок выполнения выражений
по [приоритетам операторов](https://www.php.net/manual/ru/language.operators.precedence.php).

Основные операторы:

- Арифметические операторы
- Операторы присваивания
- Операторы сравнения
- Логические операторы

**Арифметические операторы**

Арифметические операторы работают с числовыми значениями для выполнения арифметических операций.

|Пример|Название|Результат|
|---|---|---|
|+$a|Идентичность|Конвертация $a в int или float, что более подходит.|
|-$a|Отрицание|Смена знака $a.|
|$a + $b|Сложение|Сумма $a и $b.|
|$a - $b|Вычитание|Разность $a и $b.|
|$a * $b|Умножение|Произведение $a и $b.|
|$a / $b|Деление|Частное от деления $a на $b.|
|$a % $b|Деление по модулю|Целочисленный остаток от деления $a на $b.|
|$a ** $b|Возведение в степень|Возведение $a в степень $b.|

**Операторы присваивания**

Операторы присваивания записывают значения в переменные. Например, `$num1 = 5;`.

|Пример|Эквивалент|Операция|
|---|---|---|
|$a += $b|$a = $a + $b|Сложение|
|$a -= $b|$a = $a - $b|Вычитание|
|$a *= $b|$a = $a * $b|Умножение|
|$a /= $b|$a = $a / $b|Деление|
|$a %= $b|$a = $a % $b|Остаток от целочисленного деления|

**Операторы сравнения**

|Пример|Название|Результат|
|---|---|---|
|$a == $b|Равно|true если $a равно $b после преобразования типов.|
|$a === $b|Тождественно равно|true если $a равно $b и имеет тот же тип.|
|$a != $b|Не равно|true если $a не равно $b после преобразования типов.|
|$a <> $b|Не равно|true если $a не равно $b после преобразования типов.|
|$a !== $b|Тождественно не равно|true если $a не равно $b, или они разных типов.|
|$a < $b|Меньше|true если $a строго меньше $b.|
|$a > $b|Больше|true если $a строго больше $b.|
|$a <= $b|Меньше или равно|true если $a меньше или равно $b.|
|$a >= $b|Больше или равно|true если $a больше или равно $b.|
|$a <=> $b|Космический корабль (spaceship)|Число типа int меньше, больше или равное нулю, когда $a соответственно меньше, больше или равно $b.|

**Логические операторы**

|Пример|Название|Результат|
|---|---|---|
|$a xor $b|Исключающее или|true, если $a, или $b true, но не оба.|
|!$a|Отрицание|true, если $a не true.|
|$a && $b|И|true, если и $a, и $b true.|
|$a &#124;&#124; $b|Или|true, если или $a, или $b true.|

[*Дополнительная информация по операторам](https://www.php.net/manual/ru/language.operators.php)

### Управляющие структуры

**Условные конструкции**

`if` `elseif` `else`. Может быть несколько `elseif` в одном выражении `if`.

```injectablephp
<?php

$a = 0;
$b = 0;

if ($a > $b) {
    echo 'a больше, чем b';
} elseif ($a === $b) {
    echo 'a равен b';
} else {
    echo 'a меньше, чем b';
}

```

`switch` похож на оператор `if`. Подходит для сравнения переменной со множеством значений. `switch` исполняется
выражение за выражением.<br>
Код начинает исполняться с такого `case`, которое совпадает с выражением в операторе `switch`.<br>
PHP продолжает исполнять операторы до конца блока switch либо до тех пор, пока не встретит оператор break.<br>

> `switch` использует нестрогое сравнение!

```injectablephp
<?php

$i = '1';

if ($i == 0) {
    echo "i равно 0";
} elseif ($i == 1) {
    echo "i равно 1";
} elseif ($i == 2) {
    echo "i равно 2";
} else {
    echo "else. i = $i";
}

switch ($i) {
    case 0:
        echo "i равно 0";
        break;
    case 1:
        echo "i равно 1";
        break;
    case 2:
        echo "i равно 2";
        break;
    default:
        echo "default. i = $i";
}
```

`match` аналогичен оператору `switch` за исключением следующих отличий:

- `match` используется строгое сравнение `===`,
- `match` возвращает результат,
- в `match` исполняется только одна, первая подошедшая, ветвь кода, тогда как в `switch` происходит сквозное исполнение
  начиная с подошедшего условия и до первого встретившегося оператора break,
- `match` должно быть исчерпывающим.

```injectablephp
<?php

$i = '1';
$i = 1;

echo match ($i) {
    0 => "i равно 0",
    1 => "i равно 1",
    2 => "i равно 2",
    default => "default. i = $i",
};

```

**Циклы**

`while`
```injectablephp
while (условие равно true) {
   код будет выполняться;
}
```

`do ... while`
```injectablephp
do {
  выполняется код;
} while (условие равно true);
```

`for`

```injectablephp
for (init; test; increment) {
   выполняемый код;
}

init: инициализирует значение счетчика цикла;
test: оценивается каждый раз когда цикл выполняется, и цикл продолжается, пока он оценивается как истинный, и заканчивается, если он оценивается как ложный;
increment: увеличивает значение счетчика цикла.
```

`foreach`

```injectablephp
foreach (array as $value) {
  код для выполнения;
}
//или
foreach (array as $key => $value) {
   код для выполнения;
}
```

**Другие операторы**
`break` прерывает выполнение `switch` и циклов.

```injectablephp
<?php

$arr = ['один', 'два', 'три', 'четыре', 'стоп', 'пять'];
foreach ($arr as $val) {
    if ($val === 'стоп') {
        break;    /* Тут можно было написать 'break 1;'. */
    }
    echo "$val<br />\n";
}
```

`continue` используется внутри циклических структур для пропуска оставшейся части текущей итерации цикла и начала следующей.

```injectablephp
<?php

for ($i = 0; $i < 5; ++$i) {
    if ($i === 2) {
        continue;
    }
    echo "$i<br />\n";
}
```

`include` и `require` используются для подключения указанных файлов.

Файлы подключаются по указанному пути файла, а в случае, если путь не указан, используется путь, указанный в директиве `include_path`.

Далее `include` попытается проверить директорию, в которой находится текущий подключаемый скрипт и текущую рабочую директорию перед тем, как выдать ошибку.

Конструкция `include` выдаст `E_WARNING`, если не сможет найти файл; `require` выдаст `E_ERROR`.

`require_once`
`include_once`

Выражение `require_once` аналогично `require` за исключением того, что `PHP` проверит, включался ли уже данный файл, и если да, не будет включать его ещё раз.

[*Дополнительная информация по управляющим конструкциям](https://www.php.net/manual/ru/language.control-structures.php)
